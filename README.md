# Консольный калькуятор
## Лабораторная работа №1. Вариант M2
**Иванющенко Эрик Александрович. М8О-104БВ-25**

---
## Запуск
```
uv vevn
uv sync
source .venv/bin/activate
# для Windows: .venv\Scripts\activate
python -m src.main
```

---
## Короткое описание работы
- Калькулятор поддерживает целые числа и дробные через точку
- Унарные "+" и "-" не должны стоять перед другими операциями, только в начале выражения, перед или после скобки
- Допустимые операции ["+", "-", "*", "/", "//", "%", "**"]
- **Команды:**
    - help - для вывода справки
    - exit - для завершения из программы

---
## Принятые решения
- Можно писать входное выражение, как с пробелами, так и без них
- Унарный плюс не обрабатывается т.к. не влияет на результат

---
## Токены
- Токены описываются классами
- *Token* - родительский класс от которого наследуются остальные
    - Содержит методы для быстрой проверки, является ли токен числом, операцией или скобкой
- *NumberToken* - класс для чисел
    - Содержит переменную с числом
- *BracketToken* - класс для скобок
    - Содержит тип скобки открытый или закрытый
- *OperationToken* - родительский класс для операторов
    - Содержит тип ассоциативности оператора
    - Содержит приоретет операции
- От класса *OperationToken* наследуются классы операций
    - Каждый содержит метод в котором описанно как он вычисляется. Так же в этом методе идёт проверка на ошибки.
- Все токены хранятся в одном списке
- Общие методы позволяют проще работать с ними и добавлять новые операции при желании

---
## Алгоритм работы
1) Из выражения убираются пробелы и добавляется один в конец
2) Создаётся список токенов
3) Строка обрабатывается посимвольно
    - Если находится цифра или точка, программа ищет следующий символ не являющийся цифрой или точкой. Затем проверяется корректность числа, создаётся объект *NumberToken* и добавляется в список токенов
    - Если находится оператор, то в список токенов добавляется объект класса операции. (например "+" становится *AdditionToken*). Дополнительно проверяется является ли оператор унарным плюсом или минусом
    - Если находится скобка добавляется объект *BracketToken* с соответсвующим типом (открытая/закрытая)
    - Если найден пробел, обработка завершается
    - Любой другой символ вызывает ошибку
4) Происходит проверка списка токенов
5) Из списка токенов составляется список в обратной польской нотации
6) Обратная польская нотация вычисляется
7) Ответ выводится пользователю

---
## Допущения
- Унарные операторы нельзя ставить без скобок или друг за другом
- 0 ** 0 = 1
- Т.к. в списках токенов могут быть объекты разных классов, чтобы pre-commit не ругался используется typing.Any
